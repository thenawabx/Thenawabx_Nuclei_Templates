id: advanced-idor-detector

info:
  name: Insecure Direct Object Reference (IDOR) - Private Data Leak
  author: thenawabx
  severity: high
  description: Targeted at detecting unauthorized access to private data by manipulating numeric and UUID identifiers.
  tags: idor, advanced, auth, bypass

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/v1/user/{{payload}}"
      - "{{BaseURL}}/api/users/{{payload}}"
      - "{{BaseURL}}/settings/profile/{{payload}}"
      - "{{BaseURL}}/myaccount/details?id={{payload}}"
      - "{{BaseURL}}/invoice/view/{{payload}}"

    payloads:
      payload:
        # 1. Incrementing standard IDs
        - "1"
        - "2"
        - "0"
        # 2. Testing for potential admin/super-user IDs
        - "1000"
        - "1337"
        # 3. Path Traversal style IDOR
        - "1/../admin"
        # 4. JSON Format IDOR
        - "1.json"

    stop-at-first-match: false

    matchers-condition: and
    matchers:
      # 1. Verifies if common private data keys are leaked
      - type: word
        part: body
        words:
          - "email"
          - "username"
          - "full_name"
          - "address"
          - "phone"
        condition: or

      # 2. Ensures the server returns 200 OK (Access Granted)
      - type: status
        status:
          - 200

      # 3. Important: Ensure we are not just seeing a public login page
      - type: word
        part: body
        negative: true
        words:
          - "Login"
          - "Sign In"
          - "Please login to continue"
